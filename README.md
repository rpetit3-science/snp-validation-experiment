# Validating Variant Pipeline

### Overview

### Methods
##### Mutating Reference Genome
We created a python script *mutate-reference* which accepts a reference genome in FASTA format and randomly mutates positions in the genome. We set the threshold for mutations to 95% of the time be SNPs and 5% of the time InDels. A random seed of *123456* was used throughout the analysis. *mutate-reference* outputs three files, a FASTA file with the mutations, a file with information about the mutations (position, reference base, alternate base), and a file with the prameters used. 

##### Simulating Illumina Reads
The next step was to simulated Illumina reads based on the mutated reference genome. For this we used [ART](http://bioinformatics.oxfordjournals.org/content/28/4/593.abstract), a read simulator which includes errors models for multiple Illumina models. For these simulations we simulated Illumina HiSeq 2000 100bp single end reads. Each simulation used a random seed of *123456*.

##### Calling Variants
Variants (SNPs and InDels) were determined using the *[call_variants](https://github.com/rpetit3-science/call_variants)* pipeline. *call_variants* includes BWA for alignment, PicardTools for QC, GATK for variant calling, and vcf-annotator for annotation of variants. *call_variants* follows the [GATK Best Practices Workflow](https://www.broadinstitute.org/gatk/guide/best-practices).

##### Validating Variants
A python script, *validate-variants* was created to compare the called variants against the known variants created in the first step by *mutate-reference*. Reading the final VCF output of *call_variants* a we determined True Posisitves, False Positives, False Negatives and True Negatives. We have defined each of these as follows: True Positives include those called variants which are identical to known variants, False Positives are called variants which were not generated by *mutate-reference*, False Negatives are known variants which were uncalled, and True Negatives are those positions in the genome without known variants that also did not have a called variant. With these we also calculated the True Positive Rate  (TPR), False Positive Rate (FPR) and True Negative Rate (TNR).

### Results
For this analysis we tested how the pipeline worked for multiple genetic distances, as determined by number of variants, and differening coverages. We generated 12 references ranging from 100 variants to 100,000 variants. For each reference we simulated Illumina HiSeq2000 reads at 11 coverages varying from 1x to 50x. In total, 132 simulations we conducted.

##### Sensitivity

##### Specificity


### References

Weichun Huang, Leping Li, Jason R Myers, and Gabor T Marth. ART: a next-generation sequencing read simulator, Bioinformatics (2012) 28 (4): 593-594
